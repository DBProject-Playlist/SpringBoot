<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Store</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link href="https://fonts.googleapis.com/css2?family=Italianno&display=swap" rel="stylesheet">

</head>
<body>
<header>
    <div class="header-left">
        <img th:src="@{/img/music-note.png}" alt="Music Icon" class="logo">
        <span>Music Store</span>
    </div>
    <div class="header-right">
        <span class="menu-icon-btn" onclick="openNav()">â˜°</span>
    </div>
</header>

<!-- Side Navigation -->
<div id="sidenav">
    <div id="mySidenav" class="sidenav right">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        
        <a th:href="@{/home}">
            <img th:src="@{/img/home-2.png}" class="menu-icon"> Home
        </a>
        <a th:href="@{/artists}">
            <img th:src="@{/img/guitar.png}" class="menu-icon"> Artists
        </a>
        <a th:href="@{/albums}">
            <img th:src="@{/img/music3.png}" class="menu-icon"> Albums
        </a>
        <a th:href="@{/playlists}">
            <img th:src="@{/img/gallery.png}" class="menu-icon"> Playlists
        </a>

        <!-- Login / Logout -->
        <a th:if="${loggedIn}" th:href="@{/logout}" th:class="menu-icon">
            <img th:src="@{/img/key.png}" class="menu-icon"> Logout
        </a>

        <a th:unless="${loggedIn}" th:href="@{/login}" th:class="menu-icon">
            <img th:src="@{/img/key.png}" class="menu-icon"> Login
        </a>
            </div>
</div>



<div id="main">
    <!-- Search Section -->
<div class="search-section">
    <form th:action="@{/search}" method="get">
        <input type="text" name="q" placeholder="Search tracks, artists, albums..." required>
        <button type="submit">Search</button>
    </form>
</div>

    <!-- Background Section -->
    <div class="background-section">
        <h2>Welcome to Music Store</h2>
        <p>Discover your favorite tracks, albums, and artists!</p>
    </div>
    <h6 class="gradient-lined-title"></h6>

    <!-- Card Section -->
    <div class="card-container">
        <div class="card album-card">
            <img th:src="@{/img/music3.png}" alt="Album">
            <a th:href="@{/albums}" class="album-button">Albums</a>
        </div>
        <div class="card artist-card">
            <img th:src="@{/img/guitar.png}" alt="Artist">
            <a th:href="@{/artists}" class="artist-button">Artists</a>
        </div>
        <div class="card genre-card">
            <img th:src="@{/img/dj.png}" alt="Genre">
            <a th:href="@{/genres}" class="genre-button">Genres</a>
        </div>
    </div>
    <h6 class="gradient-lined-title"></h6>

    <!-- Popular Tracks & Artists Side by Side -->
    <div class="popular-section-container">

        <!-- Popular Tracks -->
        <div class="popular-section">
            <h2>ðŸ”¥ Popular Tracks</h2>
            <div class="popular-list" th:each="track, iterStat : ${popularTracks}" th:if="${iterStat.index < 5}">
                <div class="popular-item">
                    <div>
                        <span th:text="${track[0]}" class="track-name">Track Name</span>
                        <span class="artist-name">
                            <a th:href="@{'/artist/' + ${track[1]}}" th:text="${track[1]}">Artist Name</a>
                        </span>
                    </div>
                    <a href="#" class="playlist-btn">âž•</a>
                </div>
            </div>
            <a th:href="@{/popularTracks}" class="load-more">â†“ Load More Tracks</a>
        </div>

        <!-- Popular Artists -->
        <div class="popular-section">
            <h2>ðŸŒŸ Popular Artists</h2>
            <div class="popular-list" th:each="artist, iterStat : ${top5Artists}" th:if="${iterStat.index < 5}">
                <div class="popular-item">
                    <span class="artist-name">
                        <a th:href="@{'/artist/' + ${artist}}" th:text="${artist}">Artist Name</a>
                    </span>
                </div>
            </div>
            <a th:href="@{/popularArtists}" class="load-more">â†“ Load More Artists</a>
        </div>

    </div>
</div>
<h6 class="gradient-lined-title"></h6>

<!-- Playlist Section -->
<div class="playlist-section">
    

    <!-- Top Playlists (everyone sees) -->
    <h3>ðŸŽ¶ Top Playlists</h3>
    <div class="playlist-grid">
        <div class="playlist-card" 
             th:each="playlist, iterStat : ${playlists}" 
             th:if="${iterStat.index < 4}">

            <img th:src="@{'/img/' + ${playlist[0]} + '.png'}" 
                 onerror="this.onerror=null;this.src='/img/music3.png';" 
                 alt="Playlist Image">

            <a th:href="@{'/playlists/' + ${playlist[0]}}" 
               th:text="${playlist[1]}" 
               class="playlist-name">Playlist Name</a>
        </div>
    </div>


<h6 class="gradient-lined-title"></h6>

<div th:if="${loggedIn}">
    <h3>ðŸŽ¶ My Playlist</h3>
    <div class="playlist-card" th:each="playlist : ${myPlaylists}" 
         style="width:120px; text-align:center; margin:10px; padding:5px; background:#fff; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1);">
         
        <img th:src="@{'/img/' + ${playlist.id} + '.png'}"
             onerror="this.onerror=null;this.src='/img/music3.png';"
             alt="Playlist Icon"
             style="width:60px; height:60px; object-fit:contain; margin-bottom:6px;border-radius: 6px; ">
             
        <a th:href="@{'/playlists/' + ${playlist.id}}"
           th:text="${playlist.name}"
           style="display:block; font-size:12px; font-weight:500; color:#333; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">
           Playlist Name
        </a>
    </div>
</div>


<!-- Message for non-logged-in users -->
<div th:unless="${loggedIn}">
    <p>Please log in to see your personal playlists.</p>
</div>

<!-- Load More Button -->
<button class="loadMore" th:onclick="'window.location.href=\'/playlists\''">
    â†“ Load More Playlists
</button>

</div>

<!-- Footer -->
<footer style="width: 100%;">
    <p>&copy; 2025 Music Store. All rights reserved.</p>
</footer>
 


    
<script>
    function openNav() {
        document.getElementById("mySidenav").style.width = "250px";
        document.getElementById("main").style.marginRight = "250px";
    }
    
    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
        document.getElementById("main").style.marginRight = "0";
    }
    
    // Search filter function
    function filterCards() {
        const input = document.getElementById('searchInput').value.toLowerCase();
    
        const elements = document.querySelectorAll('.card, .popular-item');
        elements.forEach(el => {
            const text = el.textContent.toLowerCase();
            el.style.display = text.includes(input) ? 'flex' : 'none';
        });
    }
    
    // Optional: trigger search on Enter key
    document.getElementById('searchInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            filterCards();
        }
    });
    

    </script>
    
</body>

</html>
